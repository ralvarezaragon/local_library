install.packages('dplyr')
install.packages('shiny')
install.packages('shinydashboard')
install.packages('plotly')
install.packages('shiny')
install.packages('Rcpp')
install.packages('shinydashboard')
install.packages('shiny')
install.packages('dplyr')
data<-read.table("/tmp/query.log",header=T,sep="\t")
data<-read.table("/tmp/query.log",header=F,sep="\t")
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
View(data)
install.packages('dplyr')
install.packages('dplyr')
install.packages('shiny')
install.packages('shinydashboard')
install.packages('plotly')
shiny::runApp('Repos/local_library/r/dbatools')
install.packages('plotly')
install.packages('plotly')
install.packages('plotly')
runApp('Repos/local_library/r/dbatools')
install.packages('ssh.utils')
runApp('Repos/local_library/r/dbatools')
install.packages('reshape')
runApp('Repos/local_library/r/dbatools')
source('~/Repos/local_library/r/aws_cost_analyzer.R')
source('~/Repos/local_library/r/aws_cost_analyzer.R')
source('~/Repos/local_library/r/aws_cost_analyzer.R')
source('~/Repos/local_library/r/aws_cost_analyzer.R')
source('~/Repos/local_library/r/aws_cost_analyzer.R')
v_file
as.vector(md5sum("fcf6e27e-847c-497e-8cf6-b8c11c702e1a", pattern = "^COPY", full.names = TRUE)))
sapply(v_file, function(x) system(paste0("gzip ",x)))
sapply(v_file, function(x) system(paste0("gunzip ",x)))
v_file
system("rm -r /tmp/aws_out/*.json")
system("rm -r /tmp/aws_out/*/*/*.json")
source('~/Repos/local_library/r/aws_cost_analyzer.R')
source('~/Repos/local_library/r/aws_cost_analyzer.R')
v_file
library(data.table)
x <- fread("20170601-20170701/fcf6e27e-847c-497e-8cf6-b8c11c702e1a/daily_summary-1.csv", header = T, sep = ',')
x
str(x)
class(x)
class(x$1)
class(x[,1])
x[1]
x[,1]
x[,2]
x[,20]
x[,1,20]
x[,2]
str(x)
x$lineItem/UsageStartDate
x$UsageStartDate
x$lineItem\/UsageStartDate
replace("asd/asdasd", "/", "_")
replace("/", "asd/asdasd", "_")
substr(x, start, stop)
stringr
gsub("/", "asd/asdasd", "_")
gsub("/", "_", "asd/asdasd")
exists(x)
exists("x")
!exists("x")
eval(x)
rm(x)
x <- sapply(v_file, create_dataset(x))
source('~/Repos/local_library/r/aws_cost_analyzer.R')
source('~/Repos/local_library/r/aws_cost_analyzer.R')
source('~/Repos/local_library/r/aws_cost_analyzer.R')
rm(x)
source('~/Repos/local_library/r/aws_cost_analyzer.R')
y <- aggregate(v_file, function(x) create_dataset(x))
y <- apply(v_file, function(x) create_dataset(x))
y <- apply(v_file, 1, function(x) create_dataset(x))
y <- apply(v_file, 2, function(x) create_dataset(x))
v_file
y <- apply(v_file, 1, function(x) fread(x, header = T, sep = ','))
y <- apply(v_file, 2, function(x) fread(x, header = T, sep = ','))
y <- lapply(v_file, function(x) fread(x, header = T, sep = ','))
head(y)
ldply
isntall.pacakges("ply")
isntall.pacakges("plyr")
isntall.packages("plyr")
install.packages("plyr")
library(plyr)
t <- ply(v_file, .fun = function(x)create_dataset(x))
t <- ldply(v_file, .fun = function(x)create_dataset(x))
View(t)
class(t)
str(t)
t$product/queueType
t$`identity/TimeInterval`
names(df_result) <- gsub("/", "_", names(df_result))
df_result <- ldply(v_file, .fun = function(x)create_dataset(x))
rm(t)
names(df_result) <- gsub("/", "_", names(df_result))
str(df_result)
r <- duplicated(df, "identity_LineItemId")
names(df_result) <- gsub("/", "_", names(tolower(df_result)))
View(df_result)
tolower("Rafa")
df_result <- ldply(v_file, .fun = function(x)create_dataset(x))
names(df_result) <- gsub("/", "_", tolower(names(df_result)))
# Drop unnecesary cols
View(df_result)
df_result[1,]
head(df_result[,1])
df_result <- select(df_result, -v_to_drop)
v_to_drop <- c(
"identity_timeinterval",
"bill_invoiceid",
"bill_billingentity",
"bill_billtype",
"bill_payeraccountid",
"bill_billingperiodstartdate",
"bill_billingperiodenddate",
"lineitem_usageaccountid",
"lineitem_operation",
"lineitem_normalizationfactor",
"lineitem_normalizedusageamount",
"lineitem_blendedrate",
"lineitem_blendedcost",
"lineitem_taxtype",
"product_availability",
"product_clockspeed",
"product_contenttype",
"product_currentgeneration",
"product_databaseengine",
"product_deploymentoption",
"product_description",
"product_durability",
"product_ecu",
"product_enginecode",
"product_feecode",
"product_feedescription",
"product_freetier",
"product_fromlocation",
"product_fromlocationtype",
"product_groupdescription",
"product_instancefamily",
"product_licensemodel",
"product_locationtype",
"product_mailboxstorage",
"product_maxiopsburstperformance",
"product_maxiopsvolume",
"product_maxthroughputvolume",
"product_maxvolumesize",
"product_memory",
"product_minvolumesize",
"product_networkperformance",
"product_operatingsystem",
"product_operation",
"product_origin",
"product_physicalprocessor",
"product_preinstalledsw",
"product_processorarchitecture",
"product_processorfeatures",
"product_productfamily",
"product_recipient",
"product_requestdescription",
"product_requesttype",
"product_servicecode",
"product_sku",
"product_storage",
"product_storageclass",
"product_storagemedia",
"product_tenancy",
"product_tolocation",
"product_tolocationtype",
"product_transfertype",
"product_usagetype",
"product_vcpu",
"product_version",
"product_volumetype",
"reservation_normalizedunitsperreservation",
"reservation_totalreservednormalizedunits",
"reservation_totalreservedunits",
"reservation_unitsperreservation",
"resourcetags_aws:createdby"
)
df_result <- select(df_result, -v_to_drop)
df_result <- _select(df_result, -v_to_drop)
df_result <- df_result %>% select_(
.dots = v_to_drop
)
names(df_result) <- gsub(":", "_", tolower(names(df_result)))
source('~/Repos/local_library/r/aws_cost_analyzer.R')
View(df_result)
source('~/Repos/local_library/r/aws_cost_analyzer.R')
df_result <- df_result %>% select_(
.dots = -v_to_drop
)
df_result <- df_result %>% select_(
.dots = v_to_keep
)
v_to_keep <- c(
"identity_lineitemid",
"lineitem_lineitemtype",
"lineitem_usagestartdate",
"lineitem_usageenddate",
"lineitem_productcode",
"lineitem_usagetype",
"lineitem_availabilityzone",
"lineitem_usageamount",
"lineitem_currencycode",
"lineitem_unblendedrate",
"lineitem_unblendedcost",
"lineitem_lineitemdescription",
"product_productname",
"product_group",
"product_instancetype",
"product_location",
"pricing_publicondemandcost",
"pricing_publicondemandrate",
"pricing_term",
"pricing_unit",
"resourcetags_user_area",
"resourcetags_user_db",
"resourcetags_user_dtap",
"resourcetags_user_purpose"
)
df_result <- df_result %>% select_(
.dots = v_to_keep
)
View(df_result)
source('~/Repos/local_library/r/aws_cost_analyzer.R')
View(df_result)
df_result <- df_result %>% select_(
.dots = v_to_keep
) %>% distinct(c("identity_lineitemid", "lineitem_usagestartdate"), .keep_all = TRUE)
df_result <- df_result %>% select_(
.dots = v_to_keep
) %>% distinct("identity_lineitemid", "lineitem_usagestartdate", .keep_all = TRUE)
df_result <- df_result %>% select_(
.dots = v_to_keep
) %>% distinct("identity_lineitemid", "lineitem_usagestartdate", .keep_all = FALSE)
#Remove duplicates
View(df_result)
df_result <- df_result %>% select_(
.dots = v_to_keep
) %>% arrange("identity_lineitemid", "lineitem_usagestartdate")
df_result <- df_result %>% select_(
.dots = v_to_keep
) %>% arrange(c("identity_lineitemid", "lineitem_usagestartdate"))
df_result <- df_result %>% select_(
.dots = v_to_keep
) %>% arrange(identity_lineitemid, lineitem_usagestartdate)
View(df_result)
df_result <- df_result %>% select_(
.dots = v_to_keep
) %>% distinct(identity_lineitemid, lineitem_usagestartdate)
source('~/Repos/local_library/r/aws_cost_analyzer.R')
View(df_result)
rm(v_to_drop)
rm(y)
View(df_result)
str(df_result)
str(df_result)
df_result$lineitem_usageamount
df_result$lineitem_usageamount[1]
df_result$lineitem_usageamount[10]
df_result$lineitem_usageamount[31]
df_result$lineitem_usageamount <- round(df_result$lineitem_usageamount, 6)
View(df_result)
df_result$lineitem_usageamount[31]
df_result$lineitem_usageamount
df_result$lineitem_usageamount[882]
df_result$lineitem_usageamount <- as.float(df_result$lineitem_usageamount)
df_result$lineitem_usageamount <- as.double(df_result$lineitem_usageamount)
df_result$lineitem_usageamount[882]
df_result$lineitem_usageamount
source('~/Repos/local_library/r/aws_cost_analyzer.R')
View(df_result)
source('~/Repos/local_library/r/aws_cost_analyzer.R')
View(df_result)
as.POSIXct.date("2017-05-01T00:00:00Z")
r <- "2017-05-01T00:00:00Z"
date1 <- as.POSIXct(r, format="%Y%m%dTH%M%s")
date1
date1 <- as.POSIXct(r, format="%Y%m%d%H%M%s")
date1 <- as.POSIXct(r, format="%Y%m%d")
date1
r
class(r)
date1 <- as.POSIXct(r, format="%Y%m%d%H%m%s")
date1 <- as.POSIXct(r, format="%Y%m%dT%H%m%s")
date1 <- as.POSIXct(r, format="%Y%m%dT%H%m%sZ")
date1 <- as.POSIXct(r)
date1 <- as.POSIXlt(r)
date1 <- as.POSIXlt(r, format="%Y%m%d%H%m%s")
rm(date1)\
rm(date1)
d <- as.POSIXct(r)
rm(date1)
r1 <- gsub(r, "T", " ")
r1 <- gsub("T", " ", r)
r1 <- gsub("Z", "", r)
date1 <- as.POSIXct(r, format="%Y%m%d %H%m%s")
d1 <- as.POSIXct(r, format="%Y%m%d %H%m%s")
d1 <- as.POSIXct(r, format="%Y%m%d%H%m%s")
d1 <- as.POSIXct(r, format="%Y-%m-%dT%H:%m:%sZ")
d1 <- as.POSIXct(r, format="%Y-%m-%dT%H:%m:%s")
d1 <- as.POSIXct(r, format="%Y-%m-%d%H:%m:%s")
r1 <- gsub("T", "", r)
r1 <- gsub("Z", "", r1)
r1 <- gsub("Z", "", r)
rm (d)
rm(d1)
rm(date1)
r1 <- gsub("T", "", r)
r1 <- gsub("T", " ", r)
r1 <- gsub("Z", "", r1)
d1 <- as.POSIXct(r1, format="%Y-%m-%d %H:%M:%s")
d1 <- as.POSIXct(r, format="%Y-%m-%dT%H:%M:%s")
d1 <- as.POSIXct(r, format="%Y-%m-%dT%H:%M:%sZ")
r1 <- gsub("T", "", r)
r1 <- gsub("Z", "", r1)
r1 <- gsub("-", "", r1)
r1 <- gsub(":", "", r1)
d1 <- as.POSIXct(r1, format="%Y-%m-%d %H:%M:%s")
d1 <- as.POSIXct(r1, format="%Y%m%d%H%M%s")
d1 <- as.POSIXct(r1, format="%Y%m%d%H%M%S")
d1 <- as.POSIXct(r, format="%Y-%m-%dT%H:%M:%S")
d1 <- as.POSIXct(r, format="%Y-%m-%dT%H:%M:%OS")
d1
d1 <- as.POSIXct(r, format="%Y-%m-%dT%H:%M:%SZ")
?strptime
d1 <- as.POSIXct(r, format="%Y-%m-%dT%H:%M:%S%Z")
d1 <- as.POSIXct(r, format="%Y-%m-%dT%H:%M:%S%z")
d1 <- as.POSIXct(r, format="%Y-%m-%dT%H:%M:%S")
strptime(r, "%a %b %d %H:%M:%OS %Y")
strptime(r, "%a %b %d %H:%M:%S %Y")
strptime(r, "%a %b %d %H:%M:%S")
strptime(r, "%a-%b-%dT%H:%M:%S")
strptime(r, "%a-%b-%dT%H:%M:%S %Y")
strptime(df$Date, "%Y-%m-%dT%H:%M:%S")
strptime(r, "%Y-%m-%dT%H:%M:%S")
d1 <- as.POSIXct(r1, format="%Y%m%d%H%M%S")
d <- as.POSIXct(r, format="%Y-%m-%dT%H:%M:%S")
r1 <- "20170501010000"
d1 <- as.POSIXct(r1, format="%Y%m%d%H%M%S")
r <- "2017-05-12T18:00:00Z"
d <- as.POSIXct(r, format="%Y-%m-%dT%H:%M:%S")
source('~/Repos/local_library/r/aws_cost_analyzer.R')
View(df_result)
source('~/Repos/local_library/r/aws_cost_analyzer.R')
View(df_result)
source('~/Repos/local_library/r/aws_cost_analyzer.R')
source('~/Repos/local_library/r/aws_cost_analyzer.R')
source('~/Repos/local_library/r/aws_cost_analyzer.R')
source('~/Repos/local_library/r/aws_cost_analyzer.R')
total_per_day <- function(df){
subtotals <- df %>%
group_by(
lineitem_lineitemtype,
as.Date(lineitem_usagestartdate),
lineitem_productcode,
lineitem_currencycode,
product_instancetype,
resourcetags_user_area,
resourcetags_user_db,
resourcetags_user_dtap,
resourcetags_user_purpose
) %>%
sum(lineitem_unblendedcost)
return (df)
}
r <- total_per_day(df_result)
total_per_day <- function(df){
subtotals <- df %>%
group_by(
lineitem_lineitemtype,
as.Date(lineitem_usagestartdate),
lineitem_productcode,
lineitem_currencycode,
product_instancetype,
resourcetags_user_area,
resourcetags_user_db,
resourcetags_user_dtap,
resourcetags_user_purpose
) %>%
mutate(total_Cost = sum(lineitem_unblendedcost))
return (df)
}
r <- total_per_day(df_result)
View(r)
subtotals <- df_result %>%
group_by(
lineitem_lineitemtype,
as.Date(lineitem_usagestartdate),
lineitem_productcode,
lineitem_currencycode,
product_instancetype,
resourcetags_user_area,
resourcetags_user_db,
resourcetags_user_dtap,
resourcetags_user_purpose
)
aggregate(df_result$lineitem_unblendedcost, by=list(Date=df_result$as.Date(lineitem_usagestartdate)), FUN=sum)
total_per_day <- function(df){
subtotals <- df_result %>%
group_by(
lineitem_lineitemtype,
as.Date(lineitem_usagestartdate),
lineitem_productcode,
lineitem_currencycode,
product_instancetype,
resourcetags_user_area,
resourcetags_user_db,
resourcetags_user_dtap,
resourcetags_user_purpose
) %>%
summarise(total_Cost = sum(lineitem_unblendedcost))
return (df)
}
r <- total_per_day(df_result)
as.Date(df_result$lineitem_usagestartdate)
x <- df_result %>% group_by(as.Date(lineitem_usagestartdate))
x
View(x)
rm(list=rm())
rm(list=())
rm(list=ls())
source('~/Repos/local_library/r/aws_cost_analyzer.R')
View(df_result)
source('~/Repos/local_library/r/aws_cost_analyzer.R')
source('~/Repos/local_library/r/aws_cost_analyzer.R')
main()
rm(lilst=ls())
rm(list=ls())
main()
source('~/Repos/local_library/r/aws_cost_analyzer.R')
main()
d <- main()
source('~/Repos/local_library/r/aws_cost_analyzer.R')
d <- main()
View(d)
runApp('~/Repos/local_library/r/aws_cost_analyzer')
runApp('~/Repos/local_library/r/aws_cost_analyzer')
runApp('~/Repos/local_library/r/aws_cost_analyzer')
runApp('~/Repos/local_library/r/aws_cost_analyzer')
